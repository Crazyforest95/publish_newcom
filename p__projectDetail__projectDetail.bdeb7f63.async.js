(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{AfUN:function(e,t,n){"use strict";n.r(t);n("+L6B");var a,r,c,o,i=n("2/Rp"),s=n("2Taf"),l=n.n(s),u=n("vZ4D"),p=n.n(u),d=n("l4Ni"),f=n.n(d),m=n("ujKo"),h=n.n(m),v=n("MhPg"),g=n.n(v),y=(n("y8nQ"),n("Vl3Y")),E=n("q1tI"),_=n.n(E),j=n("MuoO"),w=n("zHco"),b=(n("2qtc"),n("kLXV")),C=(n("14J3"),n("BMrR")),k=(n("jCWc"),n("kPKH")),R=n("jehZ"),P=n.n(R),x=(n("fOrg"),n("+KLJ")),I=(n("Pwec"),n("CtXQ")),S=(n("miYZ"),n("tsqr")),O=n("p0pE"),M=n.n(O),D=(n("OaEy"),n("2fM7")),F=n("UfWW"),L=n.n(F),A=n("Plc3");function Y(e){return function(){var t,n=h()(e);if(q()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var B,J,K,T,W=y["a"].Item,z=D["a"].Option,V=(a=Object(j["connect"])(function(e){var t=e.projectManagement,n=e.menu,a=e.loading;return{list:t.list,companyId:n.companyId,loading:a.effects["projectManagement/getList"]}}),r=y["a"].create(),a(c=r((o=function(e){g()(n,e);var t=Y(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={visible:!1},e.showModal=function(){e.setState({visible:!0}),e.getPM()},e.getPM=function(){var t=e.props,n=t.dispatch,a=t.companyId;n({type:"projectManagement/getList",payload:{company_id:a,sort_id:-1,page:1,per_page:1e3,activate:1}})},e.handleOk=function(){var t=e.props,n=t.form.validateFields;n(function(n,a){if(!n){var r=M()({},a,{id:t.id,schema:"ProjectAddPmSchema"});e.add(r)}})},e.add=function(t){Object(A["g"])(t).then(function(t){t?(S["a"].success("\u63d0\u4ea4\u6210\u529f"),e.success()):S["a"].error("\u9519\u8bef")})},e.success=function(){var t=e.props,n=t.form.resetFields,a=e.props.onSuccess;a(),e.setState({visible:!1}),n()},e.handleCancel=function(){e.setState({visible:!1})},e}return p()(n,[{key:"render",value:function(){var e=this.props,t=e.list,n=e.choosedPm,a=e.form.getFieldDecorator,r=this.state.visible,c={labelCol:{xs:{span:24},sm:{span:8},md:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16}}};return _.a.createElement(E["Fragment"],null,_.a.createElement("span",null,_.a.createElement(I["a"],{type:"plus-circle",onClick:this.showModal})),_.a.createElement(b["a"],{title:"\u589e\u52a0",visible:r,onOk:this.handleOk,onCancel:this.handleCancel,width:500,destroyOnClose:!0,maskClosable:!1},t.data&&!t.data.length&&_.a.createElement(x["a"],{message:"\u8bf7\u5148\u521b\u5efa\u9879\u76ee\u7ecf\u7406\u53f7\uff0c\u518d\u521b\u5efa\u9879\u76ee",type:"warning",showIcon:!0}),_.a.createElement(y["a"],null,_.a.createElement(C["a"],{gutter:{md:20,lg:20,xl:40}},_.a.createElement(k["a"],{span:10,md:20,sm:18},_.a.createElement(W,P()({label:"\u9879\u76ee\u7ecf\u7406"},c),a("pm_id",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"}]})(_.a.createElement(D["a"],{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"},t.data.filter(function(e){return-1===L()(n,["id",e.id])}).map(function(e){return _.a.createElement(z,{key:e.id,value:e.id},e.real_name)})))))))))}}]),n}(_.a.Component),c=o))||c)||c),Z=V,H=(n("IzEo"),n("bx4M")),N=(n("g9YV"),n("wCAj")),Q=n("wd/R"),U=n.n(Q);function X(e){return function(){var t,n=h()(e);if(G()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function G(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $,ee,te,ne,ae=y["a"].Item,re=D["a"].Option,ce=(B=Object(j["connect"])(function(e){var t=e.projects,n=e.menu,a=e.loading;return{detail:t.detail,companyId:n.companyId,loading:a.effects["projectManagement/getList"]}}),J=y["a"].create(),B(K=J((T=function(e){g()(n,e);var t=X(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={visible:!1},e.showModal=function(){e.setState({visible:!0})},e.handleOk=function(){var t=e.props,n=t.pms,a=void 0===n?{}:n,r=t.form.validateFields,c=t.projectId,o=a.id;r(function(t,n){if(!t){var a=M()({},n,{old_pm_id:o,schema:"ProjectChangePmSchema",id:c});e.changePm(a)}})},e.changePm=function(t){Object(A["b"])(t).then(function(t){t?S["a"].success("\u4ea4\u63a5\u6210\u529f"):S["a"].error("\u9519\u8bef"),e.success()})},e.success=function(){var t=e.props,n=t.form.resetFields,a=e.props.onSuccess;e.setState({visible:!1}),a(),n()},e.handleCancel=function(){e.setState({visible:!1})},e}return p()(n,[{key:"render",value:function(){var e=this.props,t=e.detail.pms_engineers,n=void 0===t?[]:t,a=e.form.getFieldDecorator,r=e.pms,c=r.real_name,o=r.id,s=this.state.visible,l={labelCol:{xs:{span:24},sm:{span:8},md:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16}}};return _.a.createElement(E["Fragment"],null,_.a.createElement("span",null,_.a.createElement(i["a"],{type:"primary",onClick:this.showModal},"\u4e1a\u52a1\u4ea4\u63a5")),_.a.createElement(b["a"],{title:"\u66f4\u6362\u9879\u76ee\u7ecf\u7406",visible:s,onOk:this.handleOk,onCancel:this.handleCancel,width:500,destroyOnClose:!0,maskClosable:!1},_.a.createElement(y["a"],null,_.a.createElement(x["a"],{message:"\u9700\u6c42\u5206\u6790\u9879\u76ee\u4e2d".concat(c,"\u7684\u4e1a\u52a1\u4ea4\u63a5\u7ed9"),type:"success"}),_.a.createElement(C["a"],{gutter:{md:20,lg:20,xl:40}},_.a.createElement(k["a"],{span:10,md:20,sm:18},_.a.createElement(ae,P()({label:"\u9879\u76ee\u7ecf\u7406"},l),a("new_pm_id",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"}]})(_.a.createElement(D["a"],{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"},n.filter(function(e){return e.id!==o}).map(function(e){return _.a.createElement(re,{key:e.id,value:e.id},e.real_name)})))))))))}}]),n}(_.a.Component),K=T))||K)||K),oe=ce;function ie(e){return function(){var t,n=h()(e);if(se()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function se(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var le,ue,pe,de,fe=($=Object(j["connect"])(function(e){var t=e.projects,n=e.menu,a=e.loading;return{detail:t.detail,companyId:n.companyId,loading:a.effects["projectManagement/getList"]}}),ee=y["a"].create(),$(te=ee((ne=function(e){g()(n,e);var t=ie(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.projectRemovePmFuc=function(){var t=e.props,n=t.pms.id,a=t.projectId,r={id:a,schema:"ProjectRemovePmSchema",pm_id:n};Object(A["f"])(r).then(function(t){t?S["a"].success("\u5220\u9664\u6210\u529f"):S["a"].error("\u9519\u8bef"),e.success()})},e.projectRemovePm=function(){b["a"].confirm({content:"\u786e\u5b9a\u5220\u9664\u5417\uff1f",onOk:function(){return e.projectRemovePmFuc()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"})},e.success=function(){var t=e.props.onSuccess;t()},e}return p()(n,[{key:"render",value:function(){return _.a.createElement(E["Fragment"],null,_.a.createElement("span",null,_.a.createElement(i["a"],{type:"primary",onClick:this.projectRemovePm},"\u9879\u76ee\u7ecf\u7406\u79fb\u9664\u9879\u76ee")))}}]),n}(_.a.Component),te=ne))||te)||te),me=fe;function he(e){return function(){var t,n=h()(e);if(ve()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function ve(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var ge,ye,Ee,_e,je=y["a"].Item,we=D["a"].Option,be=(le=Object(j["connect"])(function(e){var t=e.projects,n=e.menu,a=e.loading;return{detail:t.detail,companyId:n.companyId,loading:a.effects["projectManagement/getList"]}}),ue=y["a"].create(),le(pe=ue((de=function(e){g()(n,e);var t=he(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={visible:!1},e.showModal=function(){e.setState({visible:!0})},e.getPM=function(){var t=e.props,n=t.dispatch,a=t.id;n({type:"projectManagement/getList",payload:{sort_id:-1,page:1,per_page:1e3,activate:1,project_id:a}})},e.handleOk=function(){var t=e.props,n=t.pms,a=void 0===n?{}:n,r=t.form.validateFields,c=t.engineerId,o=a.id;r(function(t,n){if(!t){var a=M()({},n,{old_pm_id:o,schema:"EngineerChangePmSchema",id:c});e.add(a)}})},e.add=function(t){var n=e.props.dispatch;n({type:"engineer/update",payload:M()({},t),callback:function(t){t?(S["a"].success("\u63d0\u4ea4\u6210\u529f"),e.success()):S["a"].error("\u9519\u8bef")}})},e.success=function(){var t=e.props,n=t.form.resetFields,a=e.props.onSuccess;e.setState({visible:!1}),a(),n()},e.handleCancel=function(){e.setState({visible:!1})},e}return p()(n,[{key:"render",value:function(){var e=this.props,t=e.detail.pms_engineers,n=void 0===t?[]:t,a=e.pms,r=void 0===a?{}:a,c=e.form.getFieldDecorator,o=r.id,i=this.state.visible,s={labelCol:{xs:{span:24},sm:{span:8},md:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16},md:{span:16}}};return _.a.createElement(E["Fragment"],null,_.a.createElement("span",null,_.a.createElement("a",{onClick:this.showModal},"\u66f4\u6362\u9879\u76ee\u7ecf\u7406")),_.a.createElement(b["a"],{title:"\u66f4\u6362\u9879\u76ee\u7ecf\u7406",visible:i,onOk:this.handleOk,onCancel:this.handleCancel,width:500,destroyOnClose:!0,maskClosable:!1},_.a.createElement(y["a"],null,_.a.createElement(C["a"],{gutter:{md:20,lg:20,xl:40}},_.a.createElement(k["a"],{span:10,md:20,sm:18},_.a.createElement(je,P()({label:"\u9879\u76ee\u7ecf\u7406"},s),c("new_pm_id",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"}]})(_.a.createElement(D["a"],{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u7ecf\u7406"},n.filter(function(e){return e.id!==o}).map(function(e){return _.a.createElement(we,{key:e.id,value:e.id},e.real_name)})))))))))}}]),n}(_.a.Component),pe=de))||pe)||pe),Ce=be;function ke(e){return function(){var t,n=h()(e);if(Re()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function Re(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Pe,xe,Ie,Se,Oe={0:"\u6309\u65e5\u7ed3\u7b97",1:"\u6309\u6708\u7ed3\u7b97"},Me={0:"\u81ea\u4e3b\u62db\u8058",1:"\u5e73\u53f0\u62db\u8058"},De=(ge=Object(j["connect"])(function(e){var t=e.loading;return{loading:t.effects["purchase/getList"]}}),ye=y["a"].create(),ge(Ee=ye((_e=function(e){g()(n,e);var t=ke(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={},e}return p()(n,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.pms,a=void 0===n?{}:n,r=e.onSuccess,c=e.id,o=a.engineers_in_project,i=void 0===o?[]:o,s=a.real_name,l=a.engineers_in_project_count,u=void 0===l?0:l,p=a.offers_in_project_count,d=void 0===p?0:p,f=a.audit_in_project_count,m=void 0===f?0:f,h=a.interview_in_project_count,v=void 0===h?0:h,g=a.enter_in_project_count,y=void 0===g?0:g,E={pageSize:5,total:u},j=[{title:"\u59d3\u540d",dataIndex:"real_name"},{title:"\u624b\u673a\u53f7",dataIndex:"phone"},{title:"\u90ae\u7bb1\u5730\u5740",dataIndex:"email"},{title:"\u5165\u9879\u65f6\u95f4",dataIndex:"now_career.start",render:function(e){return U()(new Date(e)).format("YYYY\u5e74MM\u6708DD\u65e5")}},{title:"\u62db\u8058\u5f62\u5f0f",dataIndex:"now_career.use_hr_service",render:function(e){return Me[e]}},{title:"\u8ba1\u8d39\u6a21\u5f0f",dataIndex:"now_career.salary_type",render:function(e){return Oe[e]}},{title:"\u804c\u4f4d",dataIndex:"now_career.position_level.position"},{title:"\u7ea7\u522b",dataIndex:"now_career.position_level.name"},{title:"\u4ef7\u683c",dataIndex:"now_career.position_level.money"},{title:"\u64cd\u4f5c",dataIndex:"id",render:function(e){return _.a.createElement(Ce,{onSuccess:r,pms:a,engineerId:e})}}],w=_.a.createElement("div",null,(u>0||d>0||m>0||v>0||y>0)&&_.a.createElement(oe,{onSuccess:r,pms:a,projectId:c}),0===d&&0===u&&0===m&&0===v&&0===y&&_.a.createElement(me,{onSuccess:r,pms:a,projectId:c}));return _.a.createElement(_.a.Fragment,null,_.a.createElement(H["a"],{bordered:!1,title:_.a.createElement(_.a.Fragment,null,"\u9879\u76ee\u7ecf\u7406 ",s),extra:w},_.a.createElement("div",null,_.a.createElement(N["a"],{loading:t,columns:j,rowKey:function(e){return e.id},dataSource:i,onChange:this.handleChange,pagination:M()({},E)}))))}}]),n}(E["PureComponent"]),Ee=_e))||Ee)||Ee),Fe=De;function Le(e){return function(){var t,n=h()(e);if(Ae()){var a=h()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function Ae(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Ye=(Pe=Object(j["connect"])(function(e){var t=e.projects,n=e.loading;return{detail:t.detail,loading:n.effects["projects/getDetail"]}}),xe=y["a"].create(),Pe(Ie=xe((Se=function(e){g()(n,e);var t=Le(n);function n(){var e;l()(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),e.state={},e.getList=function(){var t=e.props,n=t.dispatch,a=t.match,r=a.params.id;n({type:"projects/getDetail",payload:{id:r,schema:"ProjectWithPmsEngineers"}})},e.goBack=function(){window.history.back()},e}return p()(n,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,t=this.props,n=t.detail.pms_engineers,a=void 0===n?[]:n,r=t.match,c=t.loading,o=r.params.id,s=_.a.createElement("div",null,_.a.createElement(i["a"],{icon:"left",onClick:this.goBack},"\u8fd4\u56de"),_.a.createElement("div",{style:{marginTop:"12px"}},"\u9879\u76ee\u8be6\u60c5")),l=_.a.createElement(E["Fragment"],null,_.a.createElement(Z,{id:o,onSuccess:this.getList,choosedPm:a})," \u6dfb\u52a0\u9879\u76ee\u7ecf\u7406");return _.a.createElement(w["a"],{hiddenBreadcrumb:!0,title:s,action:l,loading:c},a.map(function(t){return _.a.createElement(Fe,{key:t.id,pms:t,id:o,onSuccess:e.getList})}),a.length<=0&&_.a.createElement("p",{style:{textAlign:"center"}},"\u6682\u65e0\u6570\u636e"))}}]),n}(E["PureComponent"]),Ie=Se))||Ie)||Ie);t["default"]=Ye}}]);